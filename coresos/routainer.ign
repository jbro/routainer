passwd:
  users:
    - name: root
      # L0tsofP0WNy
      password_hash: "$6$BOUe8yTJGlJfNOOV$ISwOdEA4y8Fv5o.OrYyKaPyc6lsgTNdnHFBzdY9MZgkMBu.GxcoIYoNAG.t.yDx5G83hXhZJYVJ4tbRVQHAnt/"
    - name: core
      ssh_authorized_keys:
        - "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDWb378qIEp40+sK6DFK22bKPf68Mo6kKpt0Y+suJBjnxcJKU+mknSlGjcps0Modlz6O5l9pcm8HTVZJhrwvQm/beY86/BG7W3rlS/AKWCf4gX/Ckr/Drw8l/awCu1J2W8qs9h+ocWzgRU3zkFOUMEl/8FMinKnNbrSrmaQ/cXrtyH5enIm4wlRSUdMlf8NrwUsZlWyttIrlZ9uFxANc4f398Tq2AOSiOyEPrZZ2IPWLlxSZA+s15zf9xLTaeo0Nkg0EDng61fxMuMKBSGz88I7a21UWRfDTGfq91t1Icsj4Bv3lbUKhGIPzIlQJMhynQRQ8GTSNFfQckrfO7lff+KCwuDt6KNQ9aS/PB3Is/lXDvlYOUZnIzoe0lGKRyDFwCaiAJpis/pPB/bcheZ0gXYSdYxUE6HdbLFIFY8Fj8ZzHpbkKWGEP54ArTlJcT//b2KlGmLQQ5rJ5eDrEBMXdn2+RnwnLCn++lqmdonOWIT2cEBZY3VTEPcY19RD4R/4DkWEjGHbDhWFBFCY1gVGUayn1rmWW9mcdEDBy1jtrn7DTMk91xlafn+bNEzgQRboDnglD5iYkWaJ1qKbCM5s2EnbW+5s+YRwMDutXpvHiELWraB7NBBaoipnjSEYMEqXidg/BN71xDGt6eX/InoiLiXhiEUSssofHCgYu/y+Kacjaw== lunchbox"
        - "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC1QqH08haJdCyCj3yheytXD44/v0JaUTP4Mjqen4K11VAyFLZ4KrTRSL20/GcNmI2s3buWUnpCpNhTlQ9xutlChz9HAcuarS0132MZdEaBjzEZ+XMnlvL88RjNTvgImn0Yzuwd0ZBSFa+ZTrKDdKXH5YY0gGJ96wfvfH/Dtr+HwGZQZVcqDly5H+bYy1rs83NwaAqNwST3GF3tYPY+NJvnU0xC2iIatz4mttSwwD80Sqyq/w9/UsuhAEFpbgG0jyvN26C7JEJmjiymfpy7rZolh7QyAIztSFu0NixdWj2QAsFUQ3qR/YyJ3Bbp6/GOj4MHMoR3PtpDbsLtJAmOvFF+QHquYpOxkPVxtC6SbuW4PSfkZaGCDt9wlZoyqrB1taZJO9Zge9kdLes9F+boarIWKGbfZYbzoQSX7uV5Dkhdnle40gg8Fgj7CKWYd9aT5NmmnyngkZEPY3jtxuzixSkck6p9CrLb2xRqJzXJyV9mFah3mpxkv1ANxmzOiF7TU1z5LUfUeLMiPHZqTQi2p1Kj8c1QKoqhXVlQAKNhm1SSjyuhYpfie8sgmF1RGkahUlMWNso3tO8NF2ORu7Ij0wAXuKoIJHIukE4P7yiWt+0uUPrW12wtYJwWXbNPAWgAgXdJfsXdzZY5IIrw2gJhF8jYlG1l2iu4QEGgawoB82rj9Q== beefy"
    - name: jbr
      shell: /data/routainer/coresos/toolbox-ssh
      ssh_authorized_keys:
        - "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDWb378qIEp40+sK6DFK22bKPf68Mo6kKpt0Y+suJBjnxcJKU+mknSlGjcps0Modlz6O5l9pcm8HTVZJhrwvQm/beY86/BG7W3rlS/AKWCf4gX/Ckr/Drw8l/awCu1J2W8qs9h+ocWzgRU3zkFOUMEl/8FMinKnNbrSrmaQ/cXrtyH5enIm4wlRSUdMlf8NrwUsZlWyttIrlZ9uFxANc4f398Tq2AOSiOyEPrZZ2IPWLlxSZA+s15zf9xLTaeo0Nkg0EDng61fxMuMKBSGz88I7a21UWRfDTGfq91t1Icsj4Bv3lbUKhGIPzIlQJMhynQRQ8GTSNFfQckrfO7lff+KCwuDt6KNQ9aS/PB3Is/lXDvlYOUZnIzoe0lGKRyDFwCaiAJpis/pPB/bcheZ0gXYSdYxUE6HdbLFIFY8Fj8ZzHpbkKWGEP54ArTlJcT//b2KlGmLQQ5rJ5eDrEBMXdn2+RnwnLCn++lqmdonOWIT2cEBZY3VTEPcY19RD4R/4DkWEjGHbDhWFBFCY1gVGUayn1rmWW9mcdEDBy1jtrn7DTMk91xlafn+bNEzgQRboDnglD5iYkWaJ1qKbCM5s2EnbW+5s+YRwMDutXpvHiELWraB7NBBaoipnjSEYMEqXidg/BN71xDGt6eX/InoiLiXhiEUSssofHCgYu/y+Kacjaw== lunchbox"
        - "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC1QqH08haJdCyCj3yheytXD44/v0JaUTP4Mjqen4K11VAyFLZ4KrTRSL20/GcNmI2s3buWUnpCpNhTlQ9xutlChz9HAcuarS0132MZdEaBjzEZ+XMnlvL88RjNTvgImn0Yzuwd0ZBSFa+ZTrKDdKXH5YY0gGJ96wfvfH/Dtr+HwGZQZVcqDly5H+bYy1rs83NwaAqNwST3GF3tYPY+NJvnU0xC2iIatz4mttSwwD80Sqyq/w9/UsuhAEFpbgG0jyvN26C7JEJmjiymfpy7rZolh7QyAIztSFu0NixdWj2QAsFUQ3qR/YyJ3Bbp6/GOj4MHMoR3PtpDbsLtJAmOvFF+QHquYpOxkPVxtC6SbuW4PSfkZaGCDt9wlZoyqrB1taZJO9Zge9kdLes9F+boarIWKGbfZYbzoQSX7uV5Dkhdnle40gg8Fgj7CKWYd9aT5NmmnyngkZEPY3jtxuzixSkck6p9CrLb2xRqJzXJyV9mFah3mpxkv1ANxmzOiF7TU1z5LUfUeLMiPHZqTQi2p1Kj8c1QKoqhXVlQAKNhm1SSjyuhYpfie8sgmF1RGkahUlMWNso3tO8NF2ORu7Ij0wAXuKoIJHIukE4P7yiWt+0uUPrW12wtYJwWXbNPAWgAgXdJfsXdzZY5IIrw2gJhF8jYlG1l2iu4QEGgawoB82rj9Q== beefy"
      groups: [ sudo ]
storage:
  filesystems:
    - name: root
      mount:
        device: /dev/disk/by-label/ROOT
        format: xfs
        wipe_filesystem: true
        label: ROOT
    - name: data
      mount:
        device: /dev/sdb
        format: xfs
        wipe_filesystem: false
        label: DATA
  files:
    - path: /etc/default/toolbox
      filesystem: root
      mode: 0644
      contents:
        inline: |
          TOOLBOX_DOCKER_IMAGE=debian
    - path: /etc/hostname
      filesystem: root
      mode: 0644
      contents:
        inline: |
          gw
    - path: /etc/systemd/timesyncd.conf
      filesystem: root
      mode: 0644
      contents:
        inline: |
          [Time]
          NTP=0.dk.pool.ntp.org 1.dk.pool.ntp.org 2.dk.pool.ntp.org 3.dk.pool.ntp.org
    - path: /etc/ssh/sshd_config
      filesystem: root
      mode: 0600
      contents:
        inline: |
          # Use most defaults for sshd configuration.
          Subsystem sftp internal-sftp
          ClientAliveInterval 180
          UseDNS no
          UsePAM yes
          PrintLastLog no # handled by PAM
          PrintMotd no # handled by PAM
          PermitRootLogin no
          AuthenticationMethods publickey
    - path: /etc/sysctl.d/ip_forward.conf
      filesystem: root
      mode: 0644
      contents:
        inline: |
          net.ipv4.ip_forward=0
systemd:
  units:
    - name: data.mount
      enable: true
      contents: |
        [Unit]
        Before=network-pre.target
        Wants=network-pre.target
        [Mount]
        What=/dev/sdb
        Where=/data
        Type=xfs
        [Install]
        WantedBy=local-fs.target
    - name: etc-systemd-network.mount
      enable: true
      contents: |
        [Unit]
        Before=network-pre.target
        After=data.mount
        Wants=network-pre.target
        [Mount]
        What=/data/routainer/overlay/network
        Where=/etc/systemd/network
        Type=none
        Options=bind
        [Install]
        WantedBy=local-fs.target
    - name: etc-systemd-nspawn.mount
      enable: true
      contents: |
        [Unit]
        Before=network-pre.target
        After=data.mount
        Wants=network-pre.target
        [Mount]
        What=/data/routainer/overlay/nspawn
        Where=/etc/systemd/nspawn
        Type=none
        Options=bind
        [Install]
        WantedBy=local-fs.target
locksmith:
  reboot_strategy: reboot
  window_start: 04:00
  window_length: 0
